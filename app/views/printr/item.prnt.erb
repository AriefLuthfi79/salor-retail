<%= "\e@" %>
<%= "\ea\x01" %>
<%= "\x1D\x61\x01" %>
<%= "\e!\x38" %><%= @order.vendor.name if @order.vendor and @order.vendor.receipt_logo_header.nil? %>
<%= "\e!\x01" %>
<%= @order.vendor.receipt_logo_header if @order.vendor %>

<%= @order.vendor.salor_configuration.receipt_blurb.to_s if @order.vendor %>
<%= "\n\e!\x01" + "\ea\x00" %>
<%= t("receipts.invoice_numer_X_at_time", :number => @order.id, :datetime => l(@order.created_at, :format => :iso)) %>

<%= @order.cash_register.name %>
<%= "\e!\x00" %>

<%= "------------------------------------------\n" %>
<%= @report[:list_of_items] %>

<% unless @report[:lc_points_discount].zero? %>
<%= "  %19.19s        %4u %8.2f\n" % [t('printr.order_receipt.lc_points_substracted'), @report[:lc_points], @report[:lc_points_discount]] %>
<% end %>
<%= "------------------------------------------" %>

<% if not @report[:discount_subtotal].zero? %>
<%= "%29s %s %8.2f\n" % [t('printr.order_receipt.subtotal1'), @report[:unit], @report[:subtotal1]] %>
<%= "%29s %s %8.2f\n" % [t('printr.order_receipt.discount_subtotal'), @report[:unit], @report[:discount_subtotal]] %>
<% end %>
<% if not @report[:rebate_subtotal].zero? %>
<%= "%29s %s %8.2f\n" % [t('printr.order_receipt.subtotal2'), @report[:unit], @report[:subtotal2]] %>
<%= "%29s %s %8.2f\n" % [t('printr.order_receipt.rebate_subtotal'), @report[:unit], @report[:rebate_subtotal]] %>
<% end %>
<% if not @report[:coupon_subtotal].zero? %>
<%= "%29s %s %8.2f\n" % [t('printr.order_receipt.subtotal3'), @report[:unit], @report[:subtotal3]] %>
<%= "%29s %s %8.2f\n" % [t('printr.order_receipt.coupon_subtotal'), @report[:unit], @report[:coupon_subtotal]] %>
<% end %>
<% if @report[:percent_rebate_amount] %>
<%= "%29s %s %8.2f\n" % [t('printr.order_receipt.subtotal4'), @report[:unit], @report[:subtotal4]] %>
<%= "%25.25s %2i%% %s %8.2f\n" % [t('printr.order_receipt.rebate_percent'), @report[:percent_rebate], @report[:unit], @report[:percent_rebate_amount] ] %>
<% elsif @report[:fixed_rebate_amount] %>
<%= "%29s %s %8.2f\n" % [t('printr.order_receipt.subtotal4'), @report[:unit], @report[:subtotal4]] %>
<%= "%29.29s %s %8.2f\n" % [t('printr.order_receipt.rebate_fixed'), @report[:unit], @report[:fixed_rebate_amount]] %>
<% end %>

<%= "%29.29s %s %8.2f\n" % [t('printr.order_receipt.subsubtotal'), @report[:unit], @report[:subsubtotal]] %>
<%= "==========================================\n" %>

<% if @report[:refund_subtotal].zero? %>
<% @report[:paymentmethods].to_a.each do |pm| %>
<%= "%9.9s %19.19s %s %8.2f\n" % [t('printr.order_receipt.given'), pm[0], @report[:unit], pm[1]] %>
<% end %>

<%= "%29.29s %s %8.2f\n" % [t('printr.order_receipt.change'), @report[:unit], @report[:change_given]] %>
<% else %>

<%= "%29.29s %s %8.2f\n" % [t('printr.order_receipt.refunded'), @report[:unit], @report[:refund_subtotal]] %>
<% end %>


<%= "\ea\x01" %>
<%= "\e!\x01" %>
<%= "          %5.5s     %4.4s  %6.6s" % [t('printr.order_receipt.net'), t('printr.order_receipt.tax'), t('printr.order_receipt.gross')] %>

<%= @report[:list_of_taxes] %>
<%= "\ea\x01" %><%= "\e!\x00" %>


<% if @report[:customer] %>
<%= @report[:customer][:company_name] %>

<%= @report[:customer][:first_name] %> <%= @report[:customer][:last_name] %>

<%= @report[:customer][:street1] %>

<%= @report[:customer][:street2] %>

<%= @report[:customer][:postalcode] %> <%= @report[:customer][:city] %>

<%= t('printr.order_receipt.current_loyalty_points') %>: -= <%= @report[:customer][:current_loyalty_points] %> =-
<% end %>

<%= @order.vendor.salor_configuration.receipt_blurb_footer.to_s if @order.vendor %>


<%= "\e!\x08" %>
<% if @order.was_printed == true  %>
---- * DUPLICATE/COPY/REPRINT * ----
<% else
  @order.update_attribute :was_printed,true
end %>

<%= @order.vendor.receipt_logo_footer if @order.vendor and @order.vendor.receipt_logo_footer %>


<%= @register.salor_printer ? '' : 'Printed with Rails' %>




<%= "\x1D\x56\x00" %>
